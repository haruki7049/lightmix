const std = @import("std");
const lightmix = @import("lightmix");
const Wave = lightmix.Wave;

test "read sine.wav" {
    const allocator = std.testing.allocator;
    var reader = std.Io.Reader.fixed(@embedFile("./assets/sine.wav"));

    const sine: Wave = Wave.read(&reader, allocator);
    defer sine.deinit();

    const expected_samples: []const f128 = &[_]f128{
        0,
        0.050111392559587389751884517960142825,
        0.1000396740623187963499862666707358,
        0.14960173345133823664052247688222907,
        0.19849238563188573870052186651203955,
        0.24665059358500930814539017914365063,
        0.2939542832728049562059389019440291,
        0.33979308450575273903622547074800867,
        0.38474684896389660328989532151249733,
        0.42771691030610065004425183874019593,
        0.46934415723136082033753471480452893,
        0.5090182195501571703238013855403302,
        0.5465865047151097140415662099063082,
        0.582262642292550431836909085360271,
        0.6153447065645313882869960631122776,
        0.6462599566637165440839869380779442,
    };
    try std.testing.expectEqualSlices(f128, sine.data[0..16], expected_samples);
}
